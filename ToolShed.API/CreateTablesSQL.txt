CREATE TABLE Address(
AddressId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
StreetName varchar(),
StreetName2 varchar(),
AptNumber varchar(),
Country varchar(),
State varchar(),
City varchar(),
ZipCode varchar(),
AddressType INT
);
CREATE TABLE Card(
CardId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
UserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Users(UserId),
CardNumber varchar(120),
CardHolderName varchar(120),
CCV varchar(5),
AddressId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Address(AddressId)
);
CREATE TABLE CardAddress(
CardAddressId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
CardId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Users(CardId),
AddressId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Address(AddressId)
);
CREATE TABLE Item(
ItemId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
TenantId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Tenant(TenantId),
DispenserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Dispenser(DispenserId),
ItemTypeId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES ItemType(ItemTypeId),
DisplayName varchar(120),
IsAvailable bit,
IsRentable bit,
IsDamaged bit,
SalePrice smallmoney,
BuyPrice smallmoney
);
CREATE TABLE ItemBundle(
ItemId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
TenantId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Tenant(TenantId),
DisplayName varchar(120)
);
CREATE TABLE ItemBundleMapping(
ItemBundleMappingId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
ItemId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Item(ItemId),
ItemBundleId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES ItemBundle(ItemBundleId)
);
CREATE TABLE ItemDetails(
ItemDetailsId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID())
);
CREATE TABLE ItemRentalDetails(
ItemRentalDetailsId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
ItemId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Item(ItemId),
PricePerHour smallmoney,
BaseRentalFee smallmoney,
LockerNumber varchar(20)
);
CREATE TABLE ItemType(
ItemTypeId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
DisplayName varchar(120)
);
CREATE TABLE Order(
OrderId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
OrderStatus int,
OrderName varchar(120)
);
CREATE TABLE OrderDetails(
OrderDetailsId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
OrderId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Order(OrderId)
ItemId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES ItemType(ItemId),
Price smallmoney
);
CREATE TABLE Rental(
RentalId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
UserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES User(UserId)
ItemRentalDetailsId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES ItemRentalDetails(ItemRentalDetailsId),
DispenserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Dispenser(DispenserId),
RentalStartTime DATETIME,
RnetalDueTime DATETIME,
RentalReturnTime DATETIME,
RentalDuration int,
PaymentID UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Payment(PaymentId),
ReturnType int,
HasBeenReturned bit,
IsUserOwnedNow bit,
LockerCode varchar(20)
);
CREATE TABLE RentalRecord(
RentalRecordId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
UserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES User(UserId)
RentalId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Rental(RentalId),
ActionType int,
Action varchar(240)
);
CREATE TABLE Tenant(
TenantId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
TenantName varchar(120),
AddressId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Address(AddressId)
);
CREATE TABLE User(
UserId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
AddressId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Address(AddressId),
FirstName varchar(30),
LastName varchar(30),
UserName varchar(30),
Email varchar(60),
Password varchar(120)
);
CREATE TABLE UserAddresses(
UserAddressId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
AddressId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Address(AddressId),
UserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES User(UserId)
);
CREATE TABLE UserCard(
UserCardId UNIQUEIDENTIFIER PRIMARY KEY DEFAULT (NEWID()),
CardId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Card(CardId),
UserId UNIQUEIDENTIFIER FOREIGN KEY REFERENCES User(UserId)
);